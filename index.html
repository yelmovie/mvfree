<!DOCTYPE html>
<html lang="ko" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>계기교육 캘린더 - 무비샘</title>

    <!-- Google Fonts: Noto Sans KR -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap"
        rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
</head>

<body>

    <!-- Header -->
    <header>
        <div class="logo-area">
            <i class="fa-regular fa-calendar-check logo-icon"></i>
            <span>계기교육 캘린더</span>
        </div>
        <div class="header-controls">
            <!-- Suggestion Button -->
            <button class="suggestion-btn" id="openSuggestionBtn" title="개발자에게 제안하기">
                <i class="fa-regular fa-lightbulb"></i>
                <span class="btn-text">제안하기</span>
            </button>

            <div class="view-toggle-group">
                <button class="view-toggle-btn active" id="viewYearBtn">전체보기</button>
                <button class="view-toggle-btn" id="viewMonthBtn">월별보기</button>
            </div>
            <span class="today-display" id="headerDate"></span>
            <button class="theme-toggle-btn" id="themeToggleBtn" title="테마 변경">
                <i class="fa-solid fa-moon"></i>
            </button>
            <!-- Admin Button -->
            <button class="admin-btn" id="openAdminLoginBtn" title="관리자 전용">
                <i class="fa-solid fa-lock"></i>
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main>
        <div class="intro-text">
            <p>📅 날짜를 눌러 오늘의 계기교육 자료를 바로 확인하세요.</p>
        </div>

        <!-- Calendar Grid -->
        <div class="calendar-container" id="calendarContainer">
            <!-- Month Cards will be inserted here by JS -->
        </div>

        <!-- Common Education Topics Section -->
        <div class="common-topics-container" id="commonTopicsContainer">
            <h2 class="section-title"><i class="fa-solid fa-tags"></i> 공통 계기교육 주제</h2>
            <div class="topics-grid" id="commonTopicsGrid">
                <!-- Topics injected by JS -->
            </div>
        </div>
    </main>

    <!-- Event Detail Modal -->
    <div class="modal-overlay" id="eventModal">
        <div class="modal-content">
            <button class="modal-close" id="closeEventModal">&times;</button>

            <div class="modal-header">
                <div class="modal-date" id="modalDate">3월 1일</div>
                <h2 class="modal-title" id="modalTitle">삼일절</h2>
                <p class="modal-desc" id="modalDesc">대한독립만세! 1919년 3월 1일...</p>
            </div>

            <div class="modal-tabs">
                <button class="tab-btn active" data-target="common">공통</button>
                <button class="tab-btn" data-target="lower">저학년 (1-3)</button>
                <button class="tab-btn" data-target="upper">고학년 (4-6)</button>
            </div>

            <div class="resource-grid" id="resourceLinks">
                <!-- Links will be injected here -->
            </div>

            <div class="teaching-tips">
                <div class="tips-title">
                    <i class="fa-solid fa-lightbulb" style="color: #fcc419;"></i> 수업 팁
                </div>
                <p id="modalNotes">
                    수업 도입부에 영상을 보여주고, 활동지를 통해 생각을 나누는 시간을 가져보세요.
                </p>
            </div>

            <!-- AI Generation Section -->
            <div class="ai-generation-area"
                style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
                <h3 style="font-size: 1.2rem; margin-bottom: 10px;">🤖 AI 선생님 자료 생성</h3>
                <p style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 10px;">
                    업스테이지 AI가 학년별 맞춤 지도안과 활동지를 만들어 드립니다.
                </p>
                <div style="display: flex; gap: 10px;">
                    <button id="btnGeneratePlan" class="resource-btn"
                        style="flex: 1; background-color: #e7f5ff; color: #1c7ed6; border: 1px solid #1c7ed6;">
                        <i class="fa-solid fa-robot"></i> 지도안/활동지 생성 (PDF)
                    </button>
                </div>
                <div id="aiLoading"
                    style="display: none; margin-top: 10px; font-size: 0.9rem; color: var(--primary-color);">
                    <i class="fa-solid fa-spinner fa-spin"></i> 자료를 생성하고 있습니다... (약 10초 소요)
                </div>
            </div>
        </div>
    </div>

    <!-- Suggestion Modal -->
    <div class="modal-overlay" id="suggestionModal">
        <div class="modal-content suggestion-modal-content">
            <button class="modal-close" id="closeSuggestionModal">&times;</button>
            <h2 class="modal-title">계기교육 아이디어 제안하기</h2>
            <p class="modal-desc">추가되었으면 하는 계기교육이나 아이디어를 알려주세요.<br>개발자가 검토 후 반영합니다.</p>

            <form id="suggestionForm">
                <div class="form-group">
                    <label for="suggestionEmail">이메일 (선택)</label>
                    <input type="email" id="suggestionEmail" placeholder="답변을 받으실 이메일 주소를 입력해주세요.">
                </div>
                <div class="form-group">
                    <label for="suggestionMessage">제안 내용 <span class="required">*</span></label>
                    <textarea id="suggestionMessage" rows="5" placeholder="자유롭게 의견을 적어주세요." required></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-cancel" id="cancelSuggestionBtn">취소</button>
                    <button type="submit" class="btn-submit">
                        <i class="fa-regular fa-paper-plane"></i> 제안 보내기
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div class="modal-overlay" id="adminLoginModal">
        <div class="modal-content admin-login-modal-content">
            <button class="modal-close" id="closeAdminLoginModal">&times;</button>
            <h2 class="modal-title">관리자 로그인</h2>
            <p class="modal-desc">관리자 비밀번호를 입력해주세요.</p>

            <form id="adminLoginForm">
                <div class="form-group">
                    <input type="password" id="adminPassword" placeholder="비밀번호" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-cancel" id="cancelAdminLoginBtn">취소</button>
                    <button type="submit" class="btn-submit">로그인</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Admin Panel Modal -->
    <div class="modal-overlay" id="adminPanelModal">
        <div class="modal-content admin-panel-modal-content">
            <button class="modal-close" id="closeAdminPanelModal">&times;</button>
            <h2 class="modal-title">관리자 전용 패널</h2>
            <p class="modal-desc">선생님들이 남겨주신 계기교육 아이디어 목록입니다.</p>

            <div class="suggestion-list-container">
                <table class="suggestion-table">
                    <thead>
                        <tr>
                            <th>날짜</th>
                            <th>이메일</th>
                            <th>내용</th>
                        </tr>
                    </thead>
                    <tbody id="suggestionListBody">
                        <!-- Suggestions injected here -->
                    </tbody>
                </table>
                <div id="noSuggestionsMsg"
                    style="display:none; text-align:center; padding: 20px; color: var(--text-muted);">
                    아직 등록된 제안이 없습니다.
                </div>
            </div>
        </div>
    </div>

    <!-- Theme Selection Modal (First Visit) -->
    <div class="modal-overlay" id="themeModal">
        <div class="modal-content splash-modal">
            <h2 class="modal-title">화면 모드를 선택해주세요</h2>
            <p>언제든지 우측 상단 버튼으로 변경할 수 있습니다.</p>

            <div class="theme-options">
                <div class="theme-option-btn" onclick="selectTheme('light')">
                    <i class="fa-solid fa-sun theme-option-icon"></i>
                    <span>밝은 화면</span>
                </div>
                <div class="theme-option-btn" onclick="selectTheme('dark')">
                    <i class="fa-solid fa-moon theme-option-icon"></i>
                    <span>어두운 화면</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <script src="js/config.js"></script>
    <script src="js/api_service.js"></script>
    <script src="js/app.js"></script>
</body>

</html>